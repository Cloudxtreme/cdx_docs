include         /etc/ldap/schema/core.schema
include         /etc/ldap/schema/cosine.schema
include         /etc/ldap/schema/nis.schema
include         /etc/ldap/schema/inetorgperson.schema
include         /etc/ldap/schema/samba.schema
include         /etc/ldap/schema/misc.schema

modulepath      /usr/lib/ldap
moduleload      back_bdb

allow bind_v2
pidfile /var/run/slapd.pid

database bdb
suffix "dc=cardiodx,dc=com"
rootdn "cn=Manager,dc=cardiodx,dc=com"
rootpw {SSHA}pykT3hkPv9JrAUTcRAlxntjvP1lazXHY

directory /data/ldap
loglevel 512
TLSCertificateFile      /etc/ldap/wildcard.cardiodx.com.crt
TLSCertificateKeyFile   /etc/ldap/wildcard.cardiodx.com.key
TLSCACertificateFile    /etc/ldap/gd_bundle.crt
# If ciphersuite is not set to high -- smbldap has issues connecting
TLSCipherSuite HIGH

# Enforces TLS connections for authentication as well as updates
security update_ssf=128 simple_bind=128
#security ssf=0

index objectClass eq
index cn pres,sub,eq
index sn pres,sub,eq
index uid pres,sub,eq
index displayName pres,sub,eq
index uidNumber eq
index gidNumber eq
index memberUID eq
index sambaSID eq
index sambaPrimaryGroupSID eq
index sambaDomainName eq
index default sub

access to attrs=userPassword,sambaNTPassword,sambaLMPassword,sambaPwdLastSet,sambaPwdMustChange
      by self write
      by anonymous auth
      by * none
access to *
        by * read

