<project name="demo (Hibernate Pojo Generator)" default="distZip" basedir=".">
<!-- Build the CLASSPATH -->
	<path id="classpath">
        <fileset dir="COTS" includes="**/*.jar" />
    </path>
	<path id="classpath.test">
        <path refid="classpath" />
        <pathelement location="bin" />
    </path>
	<target name="clean">
		<delete dir="./bin"/>
		<delete dir="./dist"/>
		<delete file="./demo.zip"/>
	</target>
    <target name="compile" description="Compiles the source code generated by the hibernate pojo generator" depends="clean">
    	<mkdir dir="./bin"/>
    	<javac srcdir="." fork="yes" destdir="bin" includes="src/**,test/unit/**" classpathref="classpath.test" debug="on" />
        <copy file="src/applicationContext.xml" todir="bin" />
    </target>
	<target name="jar" description="JARs the compiled sources" depends="compile">
		<mkdir dir="./dist"/>
		<jar basedir="bin" destfile="./dist/demo.jar"/>
	</target>
	<target name="javadoc" description="Builds the javadoc of the generated sources" depends="compile">
		<mkdir dir="./dist/docs"/>
		<javadoc classpathref="classpath" sourcepath="src" destdir="./dist/docs"/>
		<zip basedir="./dist/docs" destfile="./dist/javadocs.zip"/>
		<delete dir="./dist/docs"/>
	</target>
	<target name="distZip" depends="jar, javadoc">
		<zip basedir="./src" destfile="./dist/sources.zip"/>
		<zip basedir="./test" destfile="./dist/tests.zip"/>
		<mkdir dir="./dist/COTS"/>
		<copy todir="./dist/COTS">
			<fileset dir="./COTS" includes="**/*.jar"/>
		</copy>
		<copy todir="./dist" >
			<fileset dir="./src" includes="**/*.xml"/>
		</copy>
		<zip basedir="./dist" destfile="demo.zip"/>
	</target>
	
	<target name="jarState" description="JARs Hibernate Pojo Gen state class helper files" depends="jar">
		<mkdir dir="dist/state" />
		<jar update="false" jarfile="dist/state/hbnPojoGenState.jar" >
			<zipfileset dir="state" excludes="synchronizer.state" />
		</jar>
		<jar update="true" jarfile="./dist/demo.jar" >
			<zipfileset file="state/synchronizer.state" />
			<zipfileset src="COTS/pksClient.jar" />
		</jar>
	</target>
	
	
    <target name="testGeneratedCode" description="Execute Unit Tests" depends="compile">
        <junit printsummary="yes" fork="yes" haltonfailure="yes">
            <classpath refid="classpath.test" />
            <formatter type="plain" />
            <test name="test.com.demo.demo.DAOTest" />
        </junit>
    </target>
</project>