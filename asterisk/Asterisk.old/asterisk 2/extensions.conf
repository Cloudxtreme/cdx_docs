[general]
static=yes
writeprotect=no
autofallthrough=yes
clearglobalvars=no
priorityjumping=no
[globals]
CONSOLE=Console/dsp
IAXINFO=guest	
TRUNK=Zap/g2
TRUNKMSD=1

[dundi-e164-canonical]
[dundi-e164-customers]
[dundi-e164-via-pstn]
[dundi-e164-local]
include => dundi-e164-canonical
include => dundi-e164-customers
include => dundi-e164-via-pstn

[dundi-e164-switch]
switch => DUNDi/e164

[dundi-e164-lookup]
[macro-dundi-e164]
exten => s,1,Goto(${ARG1},1)
include => dundi-e164-lookup

[iaxtel700]
exten => _91700XXXXXXX,1,Dial(IAX2/${IAXINFO}@iaxtel.com/${EXTEN:1}@iaxtel)

[iaxprovider]

[trunkint]
exten => _9011.,1,Macro(dundi-e164,${EXTEN:4})
exten => _9011.,n,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})

[trunkld]
exten => _91NXXNXXXXXX,1,Macro(dundi-e164,${EXTEN:1})
exten => _91NXXNXXXXXX,n,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})

[trunklocal]
exten => _9NXXXXXX,1,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})

[trunktollfree]
exten => _91800NXXXXXX,1,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})
exten => _91888NXXXXXX,1,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})
exten => _91877NXXXXXX,1,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})
exten => _91866NXXXXXX,1,Dial(${TRUNK}/${EXTEN:${TRUNKMSD}})

[international]
ignorepat => 9
include => longdistance
include => trunkint

[longdistance]
ignorepat => 9
include => local
include => trunkld

[local]
ignorepat => 9
include => default
include => parkedcalls
include => trunklocal
include => iaxtel700
include => trunktollfree
include => iaxprovider

[macro-stdexten]
exten => s,1,Dial(${ARG2},20)					
exten => s,2,Goto(s-${DIALSTATUS},1)				

exten => s-NOANSWER,1,Voicemail(u${ARG1})		
exten => s-NOANSWER,2,Goto(default,s,1)			

exten => s-BUSY,1,Voicemail(b${ARG1})			
exten => s-BUSY,2,Goto(default,s,1)				

exten => _s-.,1,Goto(s-NOANSWER,1)				

exten => a,1,VoicemailMain(${ARG1})				

[macro-stdPrivacyexten]
exten => s,1,Dial(${ARG2},20|p)					
exten => s,2,Goto(s-${DIALSTATUS},1)				

exten => s-NOANSWER,1,Voicemail(u${ARG1})		
exten => s-NOANSWER,2,Goto(default,s,1)			

exten => s-BUSY,1,Voicemail(b${ARG1})			
exten => s-BUSY,2,Goto(default,s,1)				

exten => s-DONTCALL,1,Goto(${ARG3},s,1)               

exten => s-TORTURE,1,Goto(${ARG4},s,1)                

exten => _s-.,1,Goto(s-NOANSWER,1)				

exten => a,1,VoicemailMain(${ARG1})				

[demo]
exten => s,1,Wait,1			
exten => s,n,Answer			
exten => s,n,Set(TIMEOUT(digit)=5)	
exten => s,n,Set(TIMEOUT(response)=10)	
exten => s,n(restart),BackGround(demo-congrats)	
exten => s,n(instruct),BackGround(demo-instruct)	
exten => s,n,WaitExten		

exten => 2,1,BackGround(demo-moreinfo)	
exten => 2,n,Goto(s,instruct)

exten => 3,1,Set(LANGUAGE()=fr)		
exten => 3,n,Goto(s,restart)			

exten => 1000,1,Goto(default,s,1)
;exten => 1234,1,Playback(transfer,skip)	
;exten => 1234,n,Macro(stdexten,1234,${CONSOLE})

exten => 1235,1,Voicemail(u1234)		

exten => 1236,1,Dial(Console/dsp)		
exten => 1236,n,Voicemail(u1234)		

exten => #,1,Playback(demo-thanks)		
exten => #,n,Hangup			

exten => t,1,Goto(#,1)			
exten => i,1,Playback(invalid)		

exten => 500,1,Playback(demo-abouttotry)
exten => 500,n,Dial(IAX2/guest@misery.digium.com/s@default)	
exten => 500,n,Playback(demo-nogo)	
exten => 500,n,Goto(s,6)		

exten => 555,1,Dial(SIP/16505658202@10.10.37.26)

exten => 600,1,Playback(demo-echotest)	
exten => 600,n,Echo			
exten => 600,n,Playback(demo-echodone)	
exten => 600,n,Goto(s,6)		

exten => 8500,1,VoicemailMain
exten => 8500,n,Goto(s,6)

[default]
include => demo
include => fax

exten => 1234,1,Dial(SIP/1234,5)
exten => 1234,2,Voicemail(1234)

exten => 5678,1,Dial(SIP/5678,20)
exten => 5678,2,Voicemail(5678)

[macro-faxsend]
exten => s,1,SetVar(FAXFILE=/home/cchou/image.tif)
exten => s,2,SetVar(LOCALHEADERINFO=CardioDX)
exten => s,3,SetVar(LOCALSTATIONID=CardioDX)
exten => s,4,txfax(${FAXFILE}|555) 

[macro-faxreceive]
exten => s,1,SetVar(FAXFILE=/home/cchou/image1.tif)
exten => s,2,DBGet(EMAILADDR=cchou@cardiodx.com)
exten => s,3,rxfax(${FAXFILE})
exten => s,103,SetVar(EMAILADDR=cchou@cardiodx.com)
exten => s,104,Goto(3)

[fax]
exten => 2201,1,Macro(faxreceive)
exten => 2202,1,Macro(faxreceive)
exten => 2203,1,Macro(faxreceive)
exten => 2205,1,Macro(faxsend)

exten => h,1,system(/usr/local/sbin/mailfax ${FAXFILE} ${EMAILADDR} "${CALLERIDNUM} ${CALLERIDNAME}")
;exten => h,1,system(/usr/local/sbin/mailfax)


[outside]
exten => 2125551212,1,Goto(fax,5555,1)
exten => fax,1,Goto(fax,2201,1)

